{% extends "admin_base.html" %}
{% block title %}Order List{% endblock %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" href={{ url_for("static", filename="css/order.css") }}>
{% endblock %}
{% block content %}
    <main>
        <nav>
            <div id="status_wrap">
                <!--由StatusSearch組件渲染-->
            </div>
            <div id="keyword_wrap">
                <!--由SearchNav組件渲染-->
            </div>
        </nav>
        <div id="databox">

        </div>
    </main>
    <script type="text/babel">
        class StatusSearch extends React.Component{
            state = {
                order_status: "new"
            }
            render(){
                return(
                    <div>
                        <label for="">訂單狀態</label>
                        <select value={this.state.order_status} onChange={this.handleChange}>
                            <option value="new">新訂單</option>
                            <option value="all">全部訂單</option>
                            <option value="paid">已付款</option>
                            <option value="cancel">取消</option>
                        </select>
                    </div>
                )
            }
            handleChange=(eObj)=>{
                this.setState({
                    order_status: eObj.target.value
                })
            }
        }
        class KeywordSearch extends React.Component{
            state = {
                select: "order_id",
                keyword: ""
            }
            render(){
                return(
                    <div>
                        <label for="">搜尋項目</label>
                        <select value={this.state.select} onChange={this.handleChange("select")}>
                            <option value="order_id">訂單編號</option>
                            <option value="phone">聯絡電話</option>
                            <option value="checkin_date">入住日期</option>
                            <option value="create_date">訂房日期</option>
                        </select>
                        <input type="text" name="keyword" id="keyword" placeholder="請輸入關鍵字"
                            value={this.state.keyword} onChange={this.handleChange("keyword")}/>
                        <button type="submit" onClick={this.handleSubmit}>搜尋</button>
                    </div>
                )
            }
            handleSubmit=(eObj)=>{
                console.log(eObj);
            }
            handleChange=(dataType)=>{
                return(eObj=>{
                    this.setState({[dataType]: eObj.target.value});
                })
            }
        }
        addEventListener("load", ()=>{
            currentUserPromise.then(currentUser=>{
                // console.log(currentUser)
                if(currentUser!==null){
                    ReactDOM.render(<Banner id={currentUser[0]} name={currentUser[1]}/>, document.querySelector("header"));
                    ReactDOM.render(<StatusSearch />, document.querySelector("#status_wrap"));
                    ReactDOM.render(<KeywordSearch />, document.querySelector("#keyword_wrap"));
                }else{
                    location.href = `${window.origin}/admin/`
                }
            })
        })
    </script>
{% endblock %}